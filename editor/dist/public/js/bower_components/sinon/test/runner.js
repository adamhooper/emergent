(function(e,t,n){typeof require=="function"&&typeof module=="object"&&(t=require("buster-core"),n=require("formatio"),module.exports=t.extend(t,require("buster-test"),{assertions:require("buster-assertions"),eventedLogger:require("buster-evented-logger")}));var r=t.create(n);r.quoteStrings=!1;var i=t.bind(r,"ascii");t.console=t.eventedLogger.create({formatter:i,logFunctions:!0}),t.log=t.bind(t.console,"log"),t.captureConsole=function(){e.console=t.console,e.console!==t.console&&(e.console.log=t.bind(t.console,"log"))},i&&(t.assertions.format=i),e.assert=t.assertions.assert,e.refute=t.assertions.refute;var s=0,o=function(){s+=1};t.assertions.on("pass",o),t.assertions.on("failure",o),t.testRunner.onCreate(function(e){t.assertions.bind(e,{failure:"assertionFailure"}),e.console=t.console,e.on("test:async",function(){t.assertions.throwOnFailure=!1}),e.on("test:setUp",function(){t.assertions.throwOnFailure=!0}),e.on("test:start",function(){s=0}),e.on("context:start",function(e){e.testCase&&(e.testCase.log=t.bind(t.console,"log"))})}),t.testRunner.assertionCount=function(){return s};var u=t.autoRun({cwd:typeof process!="undefined"?process.cwd():null});t.testContext.on?t.testContext.on("create",u):t.testCase.onCreate=u,t.assertions.add("spy",{assert:function(e){return e!==null&&typeof e.calledWith=="function"&&!e.returns},assertMessage:"Expected object ${0} to be a spy function"}),t.assertions.add("stub",{assert:function(e){return e!==null&&typeof e.calledWith=="function"&&typeof e.returns=="function"},assertMessage:"Expected object ${0} to be a stub function"}),t.assertions.add("mock",{assert:function(e){return e!==null&&typeof e.verify=="function"&&typeof e.expects=="function"},assertMessage:"Expected object ${0} to be a mock"}),t.assertions.add("fakeServer",{assert:function(e){return e!==null&&Object.prototype.toString.call(e.requests)=="[object Array]"&&typeof e.respondWith=="function"},assertMessage:"Expected object ${0} to be a fake server"}),t.assertions.add("clock",{assert:function(e){return e!==null&&typeof e.tick=="function"&&typeof e.setTimeout=="function"},assertMessage:"Expected object ${0} to be a clock"})})(typeof global!="undefined"?global:this,typeof buster!="undefined"?buster:null,typeof formatio!="undefined"?formatio:null);